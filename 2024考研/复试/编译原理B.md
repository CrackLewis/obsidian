
## outline

- 语法制导翻译
- 中间代码生成
- 符号表
- 运行时存储空间组织
- 优化
- 目标代码生成
- 并行编译基础

## 语法制导翻译和中间代码生成

任务：语法树->中间代码

### 语法制导翻译概述

**属性文法**：
- 属性：在上下文无关文法的基础上，在描述语义动作时，为每个文法符号（终结符和非终结符）配备若干相关的值，如类型、地址等，称为*属性*。
	- 常用属性：`X.type`（X的类型）、`X.cat`（X的类别）、`X.val`（X的值或地址）
- 语义规则：与文法产生式关联的一组属性计算规则称为*语义规则*，如产生式$A\rightarrow \alpha$的描述形式为`b:=f(c1,c2,...,ck)`，其中`b,c1,c2,...,ck`为文法符号的属性，`f`是一个函数。
- 综合属性：对于产生式$A\rightarrow \alpha$的语义规则`b:=f(c1,c2,...,ck)`，`b`可以是$A$的*综合属性*，此时`c1,c2,...`是产生式右侧符号的属性，信息自下而上传递。
- 继承属性：对上述规则，`b`也可以是产生式右侧某符号的*继承属性*，`c1,c2,...`则作为$A$和其他符号的属性，信息自上而下传递。
- 属性文法：对文法每个产生式都给出其语义规则的文法称为*属性文法*。
- 翻译模式：适合语法制导翻译的另一种语言翻译的描述形式，它给出了使用语义规则进行计算的次序，以表示出某些实现细节。

**语法制导翻译方法**：
- 基本思想：随着语法分析进展，在推导或归约时便执行对应的语义子程序，在完成翻译的同时生成中间代码。
- 实现途径：增强语法分析器功能；分析栈改为语义栈（除状态、符号外加一个数值域）

### 中间语言

**后缀式**（逆波兰式）：
- 特点：运算分量的个数和先后次序不变；运算符个数不变，但其出现顺序即执行顺序；无括号。
- 定义：常规式$E_1.op.E_2$对应后缀式$E_1.E_2.op$；后缀式外部的括号可摘除。
- 推广：
	- 三目运算：$e.X.Y.￥$表示在$e\neq 0$时取$X$，$e=0$时取$Y$。
	- 转移指令：无条件跳转：$p.jump$；$e_1<e_2$时跳转：$e_1.e_2.p.jlt$；$e=0$时跳转：$e.p.jez$。

**树**：表达式和子表达式、语句组和语句的关系可以用树形结构描述。

**三地址代码**：
- 一般形式：`x:=y op z`
- 记录结构：
	- 四元式：带有四个域的记录结构`(op,arg1,arg2,result)`
		- 特点：四元式之间通过临时变量联系；单目运算只使用`arg1`；`arg1,arg2,result`是指向符号表的指针。如`(NEGATE,c,_,T1),(MUL,b,T1,T2)`。
	- 三元式：带有三个域的记录结构`(op,arg1,arg2)`
		- 特点：`arg1,arg2`指向

### 翻译说明语句

### 翻译简单算术表达式和赋值语句

### 翻译布尔表达式

### 翻译控制语句

### 翻译数组元素引用

### 翻译过程调用