
## 总体设计

### 可行性分析（略）

### 需求分析

#### 功能需求

平台需作为显示终端程序的一部分或主体，并实现如下功能：
- 接收并解析主控程序发送的动态地图样式描述，包括动态地图的结构描述和所使用的字体、图像等文件。
- 接收并解析主控程序发送的动态地图线路数据，包括线路的名称、主题色、沿线各站中英文名、线路拓扑结构等信息。
- 根据解析完毕的动态地图样式描述和线路数据信息，实现线路动态地图的自动生成和在终端上的显示。
- 接收并解析主控程序发送的列车实时状态信息，包括日期时间、列车位置、到站状态、开门侧、车门状态、紧急广播等信息，并根据这些信息更新动态地图。
- 拉取动态地图需要拉取的视频流，并正确呈现在动态地图的对应位置。

为进行功能验证，需要编写能够与平台通信的主控系统模拟程序，主控系统模拟程序需完成如下功能：
- 发现程序主机所在广播域内的显示终端，并建立与这些终端的连接。
- 选取存储在本地的动态地图样式描述，发送给显示终端。
- 选取存储在本地的动态地图线路数据，发送给显示终端。
- 通过操作程序界面修改列车的实时运行状态，并以定时自动发送和手动发送两种方式发送运行状态给显示终端。
- 向显示终端通知视频流地址，以便显示终端启动拉流；实现本地文件的推流功能，以便测试视频流功能。

本文所称主控程序，均指车载PIS的主控子系统程序，不考虑轨道交通指挥中心PIS、多线路中心PIS、单线路中心PIS等高级PIS主控系统的影响。

#### 技术需求

平台需运行于x86或ARM架构的通用计算机和嵌入式计算机下，主机应至少具备2个处理器核心和4GB内存，操作系统为Linux。主控程序需运行于x86架构的通用计算机下，主机应至少具备4个处理器核心和8GB内存，操作系统为Windows或Linux。

平台所在主机需要与主控程序处于同一广播域，以便与主控程序实现信息交换。平台和主控程序需要实现基于TCP套接字的网络连接，通过可靠连接传输动态地图的样式描述、线路数据等内容；需要实现广播或组播套接字，通过该套接字进行网络发现、定期点名和发送列车实时状态等操作。

考虑到平台可能需要在动态地图内播放视频，故平台需要根据主控程序的指令拉取网络视频流并逐帧转码为合适的图像格式，以便在地图界面上实时显示，与此同时主控程序需要通过网络指令实现视频流的播放控制。

### 总体设计框图



### 总体设计方案

输入格式设计：
- 

## 详细设计

