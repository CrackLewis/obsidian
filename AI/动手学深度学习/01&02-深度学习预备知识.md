
所有的深度学习内容基于PyTorch。

## 环境配置

参考：[doc](https://zh-v2.d2l.ai/chapter_installation/index.html#d2l)

首先创建对应的Conda环境，指定Python版本。再在创建好的环境中安装`d2l`包。

```sh
$ conda create -n d2l -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/ python=3.10.6
$ conda activate d2l
$ pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
$ pip install d2l
```

安装`d2l`之后，还需要安装一个深度学习框架。我们选择PyTorch：

```sh
$ pip install torch==1.12.0
$ pip install torchvision==0.13.0
```

从d2l的GitHub仓库上可以下载一份代码包。

代码是Jupyter Notebook形式的。如果系统里有不止一套Python环境，那么自动kernel选择可能会失效。解决方案参考：[doc](https://github.com/microsoft/vscode/issues/130946#issuecomment-1899389049)

## torch张量

```python
import torch
```

- 自然数序列：`x = torch.arange(n)`
- 张量形状：`x.shape`
- 张量元素个数：`x.numel()`
- 张量形状变换：`x.reshape(...)`
- 张量生成：
	- 全零张量：`torch.zeros(shape)`
	- 全1张量：`torch.ones(shape)`
	- 服从正态分布的随机张量：`torch.randn(shape)`
	- 基于Python列表：`torch.tensor(arr)`
- 基本运算：对应位置元素参与运算
- 张量连接：
	- 水平拼接：`torch.cat((x, y), dim=1)`
	- 垂直拼接：`torch.cat((x, y), dim=0)`
- 元素求和：`x.sum()`
- 索引：`x[1, 2]`（第1行第2列）
- 切片：`x[1:3]`（第1-2行）、`x[:, 0:3]`（第0-2列）