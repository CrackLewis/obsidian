
## 导图

（30讲第十三讲）
![[Pasted image 20230725111203.png]]
（30讲第十五讲部分）
![[Pasted image 20230725111253.png]]

## 微分方程的概念

微分方程：
表示未知函数及其导数（或者微分）与自变量之间关系的方程称为**微分方程**。一般写成：
$$
F[x,y,y',y'',\cdots,y^{(n)}]=0
$$

常微分方程：
未知函数是一元函数的微分方程称为**常微分方程**。

微分方程的相关概念：
- **阶**：方程中未知函数的最高阶导数。如$y'''-y''+6y=0$是三阶微分方程。
- **解**：将函数代入微分方程，使方程成为恒等式，则该函数称为微分方程的一个解。
- **通解**：若微分方程的解中含有的独立常数的个数等于微分方程的阶数，则该解称为微分方程的通解。
- **初始条件与特解**：确定通解中常数的条件是初始条件，根据该初始条件确定常数后得到的解称为特解。

## 一阶微分方程的求解

### 变量可分离型微分方程

能写成$y'=f(x)g(y)$的形式的方程称为**变量可分离型方程**。解法：
$$
\dfrac{dy}{dx}=f(x)g(y)\Rightarrow \int \dfrac{dy}{g(y)}=\int f(x)dx
$$

### 可化为变量可分离型的微分方程

**线性组合型**：
形如$\dfrac{dy}{dx}=f(ax+by+c)$的方程是一类可化为变量可分离型的微分方程，其中$a,b$全不为零。解法：

设$u=ax+by+c$，则$\dfrac{du}{dx}=a+b\dfrac{dy}{dx}$，因此：
$$
\dfrac{du}{dx}=a+bf(u)
$$

**齐次型**：
形如$\dfrac{dy}{dx}=\varphi\left(\dfrac{y}{x}\right)$的方程是另一类可化为变量可分离型的微分方程。解法：

设$u=\dfrac{y}{x}$，则$\dfrac{dy}{dx}=\dfrac{d(ux)}{dx}=u+x\dfrac{du}{dx}$，因此原方程变形为：
$$
x\dfrac{du}{dx}+u=\varphi(u)
$$
即：
$$
\dfrac{du}{\varphi(u)-u}=\dfrac{dx}{x}
$$

### 一阶线性微分方程

形如$y'+p(x)y=q(x)$的方程称为**一阶线性微分方程**，其中$p(x),q(x)$为已知的连续函数，其通解公式为：
$$
y=e^{-\int p(x)dx}\left[\int e^{\int p(x)dx}\cdot q(x)dx+C\right]
$$

通解公式的推导过程：
![[Pasted image 20230725124308.png]]

**通解公式的简记法**：
设$R=e^{\int p(x)dx}$，则通项公式可简记如下：
$$
y=\dfrac{1}{R}\left(C+\int qRdx\right)
$$

### 伯努利方程

形如$y'+p(x)y=q(x)y^n$（$n\neq 0,1$）的方程称为**伯努利方程**。解法：

先变形为如下形式的微分方程：
$$
y^{-n}\cdot y'+p(x)y^{1-n}=q(x)
$$
令$z=y^{1-n}$，得$\dfrac{dz}{dx}=(1-n)y^{-n}\dfrac{dy}{dx}$，则：
$$
\dfrac{1}{1-n}\cdot \dfrac{dz}{dx}+p(x)z=q(x)
$$
方程已转化为一阶线性微分方程，解之。

## 二阶可降阶微分方程的求解

**$y''=f(x,y')$型**：
方程不含未知函数$y$，只包含它的一阶和二阶导数。解法：
- 令$y'=p(x)$，$y''=p'$，则原方程变为一阶方程$\dfrac{dp}{dx}=f(x,p)$。
- 若求得其通解为$p=\varphi(x,C_1)$，即$y'=\varphi(x,C_1)$，则原方程的通解为$y=\displaystyle\int \varphi(x,C_1)dx+C_2$。

**$y''=f(y,y')$型**：
方程不含自变量$x$，只包含未知函数和它的一阶、二阶导数。解法：
- 令$y'=p$，$y''=p\dfrac{dp}{dy}$，则原方程变为一阶方程$p\dfrac{dp}{dy}=f(y,p)$。
- 若求得其通解为$p=\varphi(y,C_1)$，则由$p=\dfrac{dy}{dx}$可得$\dfrac{dy}{dx}=\varphi(y,C_1)$，分离变量得$\dfrac{dy}{\varphi(y,C_1)}=dx$。
- 两边积分得$\displaystyle\int \dfrac{dy}{\varphi(y,C_1)}=x+C_2$，即可求得原方程的通解。

## 高阶线性微分方程的求解

### 有关概念

- **二阶变系数线性微分方程**：形如$y''+p(x)y'+q(x)y=f(x)$的微分方程，其中$p(x),q(x)$称作系数函数，$f(x)$称作自由项，均为已知的连续函数。
	- **二阶变系数齐次线性微分方程**：当$f(x)\equiv 0$时，该微分方程为齐次方程。
	- **二阶变系数非齐次线性微分方程**：当$f(x)\not\equiv 0$时，该微分方程为非齐次方程。
- **二阶常系数线性微分方程**：形如$y''+py'+qy=f(x)$的微分方程，其中$p,q$为常数，$f(x)$称作自由项，是连续函数。
	- **二阶常系数齐次线性微分方程**：当$f(x)\equiv 0$时，该微分方程为齐次方程。
	- **二阶常系数非齐次线性微分方程**：当$f(x)\not\equiv 0$时，该微分方程为非齐次方程。

### 解的结构（二阶）

- 线性无关性：若$y_1(x),y_2(x)$是方程$y''+p(x)y'+q(x)y=0$的两个解，且$\dfrac{y_1(x)}{y_2(x)}\neq C$，则称$y_1(x),y_2(x)$是该方程的两个线性无关的解。
- 解的结构：
	- 齐次方程的通解：$y=C_1y_1(x)+C_2y_2(x)$，其中$y_1(x),y_2(x)$是两个线性无关解。
	- 非齐次方程的通解：$y=C_1y_1(x)+C_2y_2(x)+y^*(x)$，其中$y_1(x),y_2(x)$是对应齐次方程的两个线性无关解，$y^*(x)$是非齐次方程的一个特解。
- 解的组合性

### 二阶常系数齐次线性微分方程的通解

**字少，但必须背下来。**

对于$y''+py'+qy=0$，其对应的特征方程为$r^2+pr+q=0$，其特征根有三种情形：
- $p^2-4q>0$：设$r_1,r_2$是特征方程的两个不等实根，则$y=C_1e^{r_1x}+C_2e^{r_2x}$。
- $p^2-4q=0$：设$r$是特征方程的两重根，则$y=(C_1+C_2x)e^{rx}$。
- $p^2-4q<0$：设$\alpha\pm \beta i$是特征方程的一对共轭复根，则$y=e^{\alpha x}(C_1\cos\beta x+C_2\sin\beta x)$。

### 二阶常系数非齐次线性微分方程的特解

设该非齐次方程为$y''+py'+qy=f(x)$。

更系统的求解理论详见《高等数学》。考研范围内涉及两种情形。

**情形一：$e^{\alpha x}P_n(x)$类。** 自由项$f(x)$满足：$f(x)=e^{\alpha x}P_n(x)$，特解要设为如下形式：
$$
y^*=e^{\alpha x}Q_n(x)x^k
$$
其中：$e^{\alpha x}$照抄，$Q_n(x)$为$n$次多项式，$k$是$\alpha$在特征方程中根的重数（如果$\alpha$不是根，则$k=0$；如果是一重根，则$k=1$；如果是二重根，则$k=2$）。

**情形二：$e^{\alpha x}[P_m(x)\cos\beta x+P_n(x)\sin\beta x]$类。** 自由项$f(x)$满足：$f(x)=e^{\alpha x}[P_m(x)\cos\beta x+P_n(x)\sin\beta x]$，则特解需要设为如下样式：
$$
y^*=e^{\alpha x}[Q_l^{(1)}(x)\cos\beta x+Q_l^{(2)}\sin\beta x]x^k
$$
其中：$e^{\alpha x}$照抄，$Q_l^{(1)}(x),Q_l^{(2)}(x)$是两个$l=\max\{m,n\}$次多项式，$k$是$\alpha\pm \beta i$在特征方程中根的重数（如果$\alpha\pm \beta i$不是根，则$k=0$；如果是根，$k=1$）。

### 二阶变系数齐次线性微分方程的常数变易法（了解）

以二阶线性方程为例：如果对应齐次方程$y''+P(x)y'+Q(x)y=0$的通解为$y=C_1y_1+C_2y_2$，则非齐次方程$y''+P(x)y'+Q(x)y=R(x)$对应的通解为$y=v_1y_1+v_2y_2$，$v_1,v_2$仅和$x$有关。

解二阶非齐次线性方程的基本思路是，解出$v_1,v_2$，为此需要构造关于$v_1,v_2$的线性方程组。求导，得$y'=(v_1y_1)'+(v_2y_2)'=v_1y_1'+v_1'y_1+v_2y_2'+v_2'y_2$。通过施加约束$v_1'y_1+v_2'y_2=0$，消去导数项，得到
$$
y'=v_1y_1'+v_2y_2'
$$
继续求导，得到
$$
y''=(v_1y_1')'+(v_2y_2')'=v_1'y_1'+v_1y_1''+v_2'y_2'+v_2y_2''
$$
代入$y'',y'$到非齐次方程，有
$$
v_1'y_1'+v_2'y_2'+v_1(y_1''+Py_1'+Qy_1)+v_2(y_2''+Py_2'+Qy_2)=R
$$
由于$y_1,y_2$是齐次方程的解，所以有$v_1'y_1'+v_2'y_2'=R$。

联立方程组
$$
\left\{\begin{matrix}
v_1'y_1+v_2'y_2=0 \\
v_1'y_1'+v_2'y_2'=R
\end{matrix}\right.
$$
解出$v_1',v_2'$，积分即得到$v_1,v_2$。

对于其他阶的线性方程，如法炮制即可。

### n阶常系数齐次线性微分方程的解

方程$y^{(n)}+p_1y^{(n-1)}+\cdots +p_{n-1}y'+p_ny=0$称为 **$n$阶常系数齐次线性微分方程**，其中$p_1,p_2,\cdots,p_n$为常数。对应特征方程$r^n+p_1r^{n-1}+\cdots+p_{n-1}r+p_n=0$。

特征方程的解符合下列四种情况，分别对应通解中的一项：
- 单实根$r$：对应$Ce^{rx}$。
- $k$重实根$r$：对应$(C_1+C_2x+C_3x^2+\cdots+C_kx^{k-1})e^{rx}$。
- 一对共轭复根$\alpha\pm \beta i$（$\beta>0$）：对应$e^{\alpha x}(C_1\cos\beta x+C_2\sin\beta x)$。
- $k$重对共轭复根$\alpha\pm\beta i$：$e^{\alpha x}[(C_1+C_2x+\cdots+C_kx^{k-1})\cos\beta x+(D_1+D_2x+\cdots+D_kx^{k-1})\sin\beta x]$。

## 欧拉方程

形如$x^2\dfrac{d^2 y}{dx^2}+px\dfrac{dy}{dx}+qy=f(x)$的方程称为**欧拉方程**，其中$p,q$为常数，$f(x)$为已知连续函数，有一套固定的解法：

令$x=e^t$，则$t=\ln x$，$\dfrac{dt}{dx}=\dfrac{1}{x}$，于是：
$$
\dfrac{dy}{dx}=\dfrac{1}{x}\dfrac{dy}{dt},\dfrac{d^2 y}{dx^2}=\dfrac{1}{x^2}\left(\dfrac{d^2 y}{dt^2}-\dfrac{dy}{dt}\right)
$$
方程化为：
$$
\dfrac{d^2 y}{dt^2}+(p-1)\dfrac{dy}{dt}+qy=f(e^t)
$$
这是个一阶线性微分方程，解之。注意它只是$x>0$下的情形，如果$x<0$，则需要设$x=-e^t$，再运用类似的方法。

## 微分方程的物理应用

- 牛顿第二定律
- 变化率问题

## 微分算子法

微分算子法是一种快速求出常系数非齐次线性微分方程的手段。考研涉及的所有微分算子可归结为四种情形。

若微分方程为形如$y''+ay'+by=f(x)$的形式，则特解可以表示为：
$$
y^*=\dfrac{1}{D^2+aD+b}f(x)
$$
左边的分式中的分母称为**微分算子多项式**，右边是该算子多项式的算数。

$D$称为微分算子，满足如下性质：
- 微分性：$Df(x)=f'(x)$，$D^2 f(x)=f''(x)$，$D^k f(x)=f^{(k)}(x)$。
- 积分性：$\dfrac{1}{D}f(x)=\displaystyle\int f(x)dx$。
- 线性组合性：两个微分算子多项式可以叠加，微分算子多项式也可以和$\dfrac{1}{D}$叠加。

**情形一：纯指数型。**

特别地，若微分方程为$y''+ay'+by=e^{cx}$，则特解可以表示为：
$$
y^*=\dfrac{1}{D^2+aD+b}e^{cx}
$$

代入$D=c$到$F(D)=D^2+aD+b$，并分以下三种情形：
- 若$F(c)\neq 0$，则$y^*=\dfrac{1}{F(c)}e^{cx}$。
- 若$F(c)=0$但$\Delta=a^2-4b\neq 0$，则$y^*=\dfrac{x}{F'(c)}e^{cx}$。
- 若$F(c)=0$且$\Delta=a^2-4b=0$，则$y^*=\dfrac{x^2}{F''(c)}e^{cx}$。

归纳为：
$$
y^*=\dfrac{x^ke^{cx}}{F^{(k)}(c)}
$$
其中$k$是$c$在方程$F(D)=0$中的重数。

**情形二：纯三角型。**

特解为下列形式：
$$
y^*=\dfrac{1}{D^2+aD+b}\sin cx 或 y^*=\dfrac{1}{D^2+aD+b}\cos cx
$$

如果$a=0$，则直接代入$D^2=-c^2$到$F(D)=D^2+b$，并分以下两种情形：
- 若$F(\pm ci)\neq 0$，则$y^*=\dfrac{1}{b-c^2}\sin cx$或$y^*=\dfrac{1}{b-c^2}\cos cx$。
- 若$F(\pm ci)=0$，则$y^*=x\dfrac{\sin cx}{2D}=-\dfrac{x}{2c}\cos cx$或$y^*=x\dfrac{\cos cx}{2D}=\dfrac{x}{2c}\sin cx$。

归纳为：
$$
y^*=x^k\dfrac{\sin cx}{F^{(k)}(\pm ci)}或 y^*=x^k\dfrac{\cos cx}{F^{(k)}(\pm ci)}
$$
其中$k$是$c$在方程$F(D)=0$中的重数。

如果$a\neq 0$，则先代入$D^2=-c^2$，转化为下列特解形式：
$$
y^*=\dfrac{1}{b-c^2+aD}\sin cx或y^*=\dfrac{1}{b-c^2+aD}\cos cx
$$
对于三角型而言，解决左侧的微分算子分式的最简方法是分母构造平方差（以$\sin cx$为例）：
$$
\begin{split}
y^*&=\dfrac{1}{b-c^2+aD}\sin cx=\dfrac{b-c^2-aD}{(b-c^2)^2+a^2c^2}\sin cx \\
&=\dfrac{b-c^2}{(b-c^2)^2+a^2c^2}\sin cx-\dfrac{ac}{(b-c^2)^2+a^2c^2}\cos cx
\end{split}
$$

**情形三：多项式型。**

特解为下列形式：
$$
y^*=\dfrac{1}{D^2+aD+b}P_n(x)
$$
这种情况一般考虑对左侧的微分算子式进行级数展开，展开一般到$n$阶，这里以$4$阶为例：
$$
\dfrac{1}{D^2+aD+b}=\dfrac{1}{b}-\dfrac{a^2}{b}D+\dfrac{a^2-b}{b^3}D^2-\dfrac{a^3-2ab}{b^4}D^3+\dfrac{a^4-3a^2b+b^2}{b^5}D^4+O(D^5)
$$
然后根据级数展开结果求导即可。

**情形四：指数混合型。**

特解为下列形式：
$$
y^*=\dfrac{1}{D^2+aD+b}e^{cx}v(x)
$$
其中$v(x)$为任意的实函数。

下面的规律可以分离开$F(D)=D^2+aD+b$和$v(x)$，从而转化为上面三种微分算子类型：
$$
y^*=e^{cx}\dfrac{1}{F(D+c)}v(x)=e^{cx}\cdot\dfrac{1}{(D+c)^2+a(D+c)+b}v(x)
$$

