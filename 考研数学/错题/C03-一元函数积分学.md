
## 进度

- [ ] 全书基础
- [ ] 660题
- [ ] 张宇30讲
- [ ] 高数18讲
- [ ] 张宇1000题

## 张宇30-P128：原函数和定积分的存在性

在区间$[-1,2]$上，说明下列函数是否有原函数，是否有定积分：
- $f_1(x)=\left\{\begin{matrix}2, & x>0,\\ 1,&x=0,\\ -1, & x<0\end{matrix}\right.$
- $f_2(x)=\left\{\begin{matrix}2x\sin \dfrac{1}{x^2}-\dfrac{2}{x}\cos \dfrac{1}{x^2}, & x\neq 0, \\ 0, & x=0\end{matrix}\right.$
- $f_3(x)=\left\{\begin{matrix}\dfrac{1}{x}, & x\neq 0,\\ 0, & x=0\end{matrix}\right.$
- $f_4(x)=\left\{\begin{matrix}2x\cos \dfrac{1}{x}+\sin \dfrac{1}{x}, & x\neq 0,\\ 0, & x=0\end{matrix}\right.$

**思路**：

$f_1(x)$在$x=0$处有跳跃间断点，因此在区间内没有原函数和定积分。

$f_2(x)$在$x=0$处有振荡间断点。通过构造可以构造出$F_2(x)$，使得$F_2'(x)=f_2(x)$：
$$
F_2(x)=\left\{\begin{matrix}
x^2\sin \dfrac{1}{x^2}, & x\neq 0,\\
0, & x=0
\end{matrix}\right.
$$
可见$f_2(x)$有原函数。但由于$f_2(x)$在$x=0$的任一邻域内无界，所以在区间内无定积分。

$f_3(x)$在$x=0$处有无穷间断点，因此不存在原函数和定积分。

$f_4(x)$在$x=0$处有振荡间断点。通过构造可以构造出$F_4(x)$，使得$F_4'(x)=f_4(x)$：
$$
F_4(x)=\left\{\begin{matrix}
x^2\cos \dfrac{1}{x}, & x\neq 0, \\
0, & x=0
\end{matrix}\right.
$$
可见$f_4$有原函数。而$f_4(x)$在$x=0$附近有界，所以在区间内有定积分。

**总结**：
参考[[Z03-一元函数积分学#^de11d1|不定积分存在定理]]的有关内容：
- 连续函数$f(x)$必有原函数$F(x)$。
- 含有第一类间断点和无穷间断点的函数$f(x)$在包含该间断点的区间内无原函数。

含有振荡间断点的函数比较特殊，可能存在原函数也可能不存在。如果原函数存在，则若函数**在闭区间内有界且有有限个振荡间断点**，则定积分也存在。

## 张宇30-P131：原函数的奇偶性

设$f(x)$连续，则下列两个函数中必为偶函数的是：
- $\displaystyle\int_0^x t[f(t)-f(-t)]dt$
- $\displaystyle\int_0^x t[f(t)+f(-t)]dt$

**思路**：
函数$g(x)=x[f(x)-f(-x)]$必为偶函数，$h(x)=x[f(x)+f(-x)]$必为奇函数。因此它们基于$x=0$的变上限积分函数分别为奇函数和偶函数。

因此第二个函数必为偶函数。

**总结**：
当时没转过弯来，选了第一个。

## 张宇30-P131：定积分的保号性

设$f(x)$在$[a,b]$上非负连续，且$f(x)$不恒为零，证明必有$\displaystyle\int_a^b f(x)dx>0$。

**思路**：
根据题意，存在$x_0\in(a,b)$，满足$f(x_0)>0$。

因函数连续，故有$\displaystyle\lim_{x\rightarrow x_0} f(x_0)=f(x_0)>0$，由极限的保号性知，存在$\delta>0$和$\eta>0$，使得当$x_0\in[x_0-\delta,x_0+\delta]$时，恒有$f(x)\ge \eta\ge 0$。

根据定积分的不等式性质，有：
$$
\int_a^b f(x)dx\ge \int_{x_0-\delta}^{x_0+\delta} f(x)dx\ge \eta\int_{x_0-\delta}^{x_0+\delta} dx=2\eta\delta>0
$$

**总结**：
保号性允许进行定量分析，具体是设邻域半径$\delta$和边界宽度$\eta$。

## 张宇30-P132：凑微分法计算不定积分

计算$\displaystyle\int \dfrac{1}{\sqrt{x(1-x)}}dx$。

**思路**：
考虑提出$\sqrt{x}$并拼凑微元$d\sqrt{x}$：
$$
\begin{split}
\int \dfrac{1}{\sqrt{x(1-x)}}dx&=\int \dfrac{2}{\sqrt{1-x}}d\sqrt{x}\\
&=2\int \dfrac{1}{\sqrt{1-(\sqrt{x})^2}}d\sqrt{x}=2\arcsin \sqrt{x}+C
\end{split}
$$

**总结**：
一个比较经典的题目了。对分母带根号的原则是应用凑微分法或换元法优先进行处理。

## 张宇30-P133：分母带根号类不定积分的推导

求$\displaystyle\int \dfrac{dx}{\sqrt{x^2-a^2}}$（$a>0$）。

**思路**：
设$x=a\sec t$，有$dx=a\sec t\tan tdt$。

当$0<t<\dfrac{\pi}{2}$时，$x=a\sec t>0$，且存在反函数，因此：
$$
\begin{split}
\int \dfrac{dx}{\sqrt{x^2-a^2}}&=\int \dfrac{a\sec t\tan t}{a\tan t}dt=\int \sec tdt\\
&=\ln(\sec t+\tan t)+C_1=\ln(x+\sqrt{x^2-a^2})+C
\end{split}
$$
当$\dfrac{\pi}{2}<t<\pi$时，$x=a\sec t<0$，且存在反函数，因此：
$$
\begin{split}
\int \dfrac{dx}{\sqrt{x^2-a^2}}&=-\int \sec tdt=\ln(-x-\sqrt{x^2-a^2})+C
\end{split}
$$
综合起来有：
$$
\int \dfrac{dx}{\sqrt{x^2-a^2}}=\ln\left|x+\sqrt{x^2-a^2}\right|+C
$$

**总结**：
本来不想记录本题的，但突然感觉有必要说明类似类型的不定积分是如何推导的。本题的这个积分是通过三角换元计算的，同时需要处理还原前后的符号变化问题。

## 张宇30-P134：凑微分法计算不定积分

求$\displaystyle\int\dfrac{1}{1+\sin x}dx$。

**思路**：
可以通过三角恒等变形计算：
$$
\int \dfrac{1}{1+\sin x}dx=\int \dfrac{1-\sin x}{\cos^2 x}dx=\tan x-\dfrac{1}{\cos x}+C
$$
也可以通过分母配方进行计算：
$$
\begin{split}
\int \dfrac{1}{1+\sin x}dx&=\int \dfrac{dx}{\left(\cos \dfrac{x}{2}+\sin \dfrac{x}{2}\right)^2}=\int \dfrac{\sec^2 \dfrac{x}{2}}{\left(1+\tan \dfrac{x}{2}\right)^2}dx \\
&=2\int \dfrac{d\left(1+\tan \dfrac{x}{2}\right)}{\left(1+\tan \dfrac{x}{2}\right)^2}=-\dfrac{2}{1+\tan \dfrac{x}{2}}+C
\end{split}
$$

**总结**：
碰到这题好几回了，每次都错。核心矛盾仍然是背那几个基本的定积分。

## 张宇30-P134：换元法和分部积分法计算不定积分

求$\displaystyle\int (\arcsin x)^2dx$。

**思路**：
分部积分法和凑微分法适用于本题的计算：
$$
\begin{split}
\int (\arcsin x)^2 dx&=x(\arcsin x)^2-\int \dfrac{2x\arcsin x}{\sqrt{1-x^2}}dx \\
&=x\arcsin^2 x+2\int \arcsin xd(\sqrt{1-x^2}) \\
&=x\arcsin^2 x+2\sqrt{1-x^2}\arcsin x-2x+C
\end{split}
$$
另外，换元法也可以做。令$u=\arcsin x$，则$x=\sin u$，$dx=\cos udu$：
$$
\begin{split}
\int (\arcsin^2 x)dx&=\int u^2 \cos udu=\int u^2d(\sin u)\\
&=u^2\sin u-\int 2u\sin udu\\
&=u^2\sin u-2\left[u(-\cos u)-\int (-\cos u)du\right] \\
&=u^2\sin u+2u\cos u-2\sin u+C\\
&=x\arcsin^2 x+2\sqrt{1-x^2}\arcsin x-2x+C
\end{split}
$$

**总结**：
$(\arcsin x)^k$等初等函数的幂相对更适合使用分部积分法计算不定积分。

## 张宇30-P134：求不定积分的综合题

求$\displaystyle\int \dfrac{xe^{\arctan x}}{(1+x^2)^{\frac{3}{2}}}dx$。

**思路**：
分部法是可行的，但要进行两次分部积分，最后还需要解出积分：
$$
\begin{split}
\displaystyle\int \dfrac{xe^{\arctan x}}{(1+x^2)^{\frac{3}{2}}}dx &= \int \dfrac{x}{\sqrt{1+x^2}}d(e^{\arctan x})=\dfrac{xe^{\arctan x}}{\sqrt{1+x^2}}-\int \dfrac{e^{\arctan x}}{(1+x^2)^{\frac{3}{2}}}dx \\
&= \frac{xe^{\arctan x}}{\sqrt{1+x^2}}-\int \frac{1}{\sqrt{1+x^2}}d(e^{\arctan x})\\
&=\frac{(x-1)e^{\arctan x}}{\sqrt{1+x^2}}-\int \dfrac{xe^{\arctan x}}{(1+x^2)^{\frac{3}{2}}}dx
\end{split}
$$
解得：
$$
\int \frac{xe^{\arctan x}}{(1+x^2)^{\frac{3}{2}}}dx=\frac{(x-1)e^{\arctan x}}{2\sqrt{1+x^2}}+C
$$

另外，设$x=\tan t$，也可通过换元法解：
$$
I=\int \frac{e^t\tan t}{(1+\tan^2 t)^{\frac{3}{2}}}\sec^2t dt=\int e^t\sin tdt
$$
又$\displaystyle\int e^t\sin t dt=\dfrac{1}{2}e^t(\sin t-\cos t)+C$，所以：
$$
I=\frac{(x-1)e^{\arctan x}}{2\sqrt{1+x^2}}+C
$$

**总结**：
如果对$\int uvdx$进行多次分部积分，应当尽量避免对同一个部分进行多次积分，除非是积分特别显然或者明显能够简化运算的情形。

## 张宇30-P139：定积分的计算

求$\displaystyle \int_{-1}^1 x^2\sqrt{1-x^2}dx$。

**思路**：
通过换元$x=\sin t$易得：
$$
I=\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin^2 t\cos^2 t dt=\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} (\sin^2 t-\sin^4 t)dt
$$
根据华里士公式得知：
$$
I=2\int_0^{\frac{\pi}{2}} (\sin^2 t-\sin^4 t)dt=2\left(\dfrac{1}{2}\cdot\dfrac{\pi}{2}-\dfrac{3}{4}\cdot\dfrac{1}{2}\cdot\dfrac{\pi}{2}\right)=\frac{\pi}{8}
$$

**总结**：
积极运用换元法和华里士公式解决带$\sqrt{a^2-x^2}$的定积分。

**华里士公式**：
设$I_1=\displaystyle\int_0^{\frac{\pi}{2}} \sin^n xdx$，$I_2=\displaystyle\int_0^{\frac{\pi}{2}} \cos^n xdx$。则： ^e96474
$$
I_1=I_2=\left\{
\begin{matrix}
\dfrac{n-1}{n}\cdot\dfrac{n-3}{n-2}\cdot \cdots\cdot\dfrac{4}{5}\cdot\dfrac{2}{3}, & n为奇数,\\
\dfrac{n-1}{n}\cdot\dfrac{n-3}{n-2}\cdot \cdots\cdot\dfrac{3}{4}\cdot\dfrac{1}{2}\cdot\dfrac{\pi}{2}, & n为偶数
\end{matrix}
\right.
$$

## 张宇30-P140：换元法计算定积分

求$\displaystyle\int_0^{\frac{\pi}{4}} \ln(1+\tan x)dx$。

**思路**：
令$x=\dfrac{\pi}{4}-t$，得$\tan x=\dfrac{1-\tan t}{1+\tan t}$，则：
$$
\begin{split}
\int_0^{\frac{\pi}{4}} \ln(1+\tan x)dx&=\int_{\frac{\pi}{4}}^0 \ln\dfrac{2}{1+\tan t}(-dt)\\
&=-\int_0^{\frac{\pi}{4}}\ln(1+\tan t)dt+\int_0^{\frac{\pi}{4}}\ln 2dt\\
&=\frac{\pi}{4}\ln 2-\int_0^{\frac{\pi}{4}}\ln(1+\tan x)dx
\end{split}
$$
解得：
$$
\displaystyle\int_0^{\frac{\pi}{4}} \ln(1+\tan x)dx=\frac{\pi}{8}\ln 2
$$

**总结**：
众多定积分的计算问题都会用到定积分的“区间再现公式”： ^de2aa5
$$
\int_a^b f(x)dx=\int_a^b f(a+b-x)dx
$$
对于本题，则是通过换元构造了区间的再现形式。

## 张宇30-P111：华里士公式的应用

求$I=\displaystyle\int_{0}^6 x^2\sqrt{6x-x^2}dx$。

**思路**：
令$x=3+3\sin t$，有：
$$
\begin{split}
I&=\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} (3+3\sin t)^2 \sqrt{9-9\sin^2 t}\cdot 3\cos tdt \\
&=81\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} (1+\sin t)^2 \cos^2 tdt\\
&=81\left[\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}\cos^2 tdt+\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}\sin^2 t\cos^2 tdt+2\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin t\cos^2 tdt \right]\\
&=162I_2+162(I_2-I_4)=\frac{405}{8}\pi
\end{split}
$$

**总结**：
注意倒数第二行的那一项是奇函数，因此取值是0。

## 张宇30-P143：超越函数的定积分

设$f(x)=\displaystyle\int_1^{x^2} e^{-t^2}dt$，求$I=\displaystyle\int_0^1 xf(x)dx$。

**思路**：
$f(x)$本身是不可积函数，所以要尽可能使用其他积分办法而不是直接求$f(x)$的原函数。

根据分部积分公式：
$$
\int_0^1 xf(x)dx=\left.\frac{x^2}{2}f(x)\right|_{0}^1-\int_0^1 \frac{x^2}{2}f'(x)dx
$$
可见，如果能得出$f(1),f'(x)$，即可求出$I$。

发现$f(1)=0$，又$f'(x)=e^{-x^4}(x^2)'=2xe^{-x^4}$，因此：
$$
\begin{split}
\int_0^1 xf(x)dx&=-\int_0^1 \frac{x^2}{2}\cdot 2xe^{-x^4}dx=-\int_0^1 x^3e^{-x^4}dx=\frac{1}{4}\int_0^1 e^{-x^4}d(-x^4)\\
&=\left.\frac{1}{4} e^{-x^4}\right|_{0}^1=\frac{1}{4}(e^{-1}-1)
\end{split}
$$

**总结**：
当被积的积分中有超越函数时，可以考虑构造分部积分形$\int udv$，其中$u$为超越函数，则求积分时可以避免直接求其积分。

## 张宇30-P144：变限积分函数求导

设$f(x)$连续，求$\dfrac{d}{dx}\left[\displaystyle\int_0^x tf(x^2-t^2)dt\right]$。

**思路**：
设$x^2-t^2=u$，则$du=-2tdt$，因此：
$$
\begin{split}
\dfrac{d}{dx}\left[\displaystyle\int_0^x tf(x^2-t^2)dt\right]&=-\frac{1}{2}\frac{d}{dx}\left[\int_{x^2}^0 f(x^2-t^2)d(x^2-t^2)\right]\\
&=\frac{1}{2}\frac{d}{dx}\int_0^{x^2} f(u)du\\
&=\frac{1}{2}\cdot 2xf(x^2)=xf(x^2)
\end{split}
$$

**总结**：
如果被积函数中的某一项出现了$x,t$的混合项，**必须**通过换元方式消解掉。

## 张宇30-P145：反常积分的求解

求$\displaystyle\int_{\frac{1}{2}}^{\frac{3}{2}} \dfrac{dx}{\sqrt{|x-x^2|}}$。

**思路**：
首先，由于瑕点$x=1$在区间内部，所以必须以该点为中心，分拆为两个无界区间的反常积分：
$$
\begin{split}
I&=I_1+I_2=\int_{\frac{1}{2}}^{1}\frac{dx}{\sqrt{x-x^2}}+\int_{1}^{\frac{3}{2}}\frac{dx}{\sqrt{x^2-x}} \\
\end{split}
$$
用换元法计算$I_1$：
$$
I_1=2\int_{\frac{1}{2}}^1 \frac{1}{\sqrt{1-(\sqrt{x})^2}}d(\sqrt{x})=\left[2\arcsin \sqrt{x}\right]_{\frac{1}{2}}^{1}=\frac{\pi}{2}
$$
用配方法或换元法计算$I_2$：
$$
I_2=2\int_1^{3/2} \frac{1}{\sqrt{(\sqrt{x})^2-1}}d(\sqrt{x})=\left[2\ln(\sqrt{x}+\sqrt{x-1})\right]_{1}^{3/2}=\ln(2+\sqrt{3})
$$
因此$I=\ln(2+\sqrt{3})+\dfrac{\pi}{2}$。

**总结**：
一刷时由于马虎，算错了$I_1$，二刷注意。

## 张宇30-P147：反常积分的敛散性讨论

讨论$I=\displaystyle\int_2^{+\infty} \dfrac{1}{x\ln^p x}dx$的敛散性。

**思路**：
本题很巧的是$x$的指数正好卡在1上，导致对$p$需要讨论。

对任意$p\neq 1$，有：
$$
I=\int_2^{+\infty} \frac{1}{\ln^p x}d(\ln x)=\left[\frac{1}{1-p}\ln^{1-p}x\right]_{2}^{+\infty}
$$
当$p=1$时，积分式等于$\left[\ln|\ln x|\right]_{2}^{+\infty}$，发散。

当$p<1$时，积分式发散；当$p>1$时，积分式收敛。

**总结**：
一个挺特殊的题目，启示：敛散性有时需要求出全部或部分积分式，才能准确地分析出，而不是仅仅依赖以幂为标准的审敛法。