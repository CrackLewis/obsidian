
## 框架

- 文件系统基础
	- 文件的基本概念
	- 文件控制块和索引节点
	- 文件的操作
	- 文件保护
	- 文件的逻辑结构
	- 文件的物理结构
- 目录
	- 目录的基本概念
	- 目录结构
	- 目录的操作
	- 文件共享
- 文件系统
	- 文件系统结构
	- 文件系统布局
	- 外存空闲空间管理
	- 虚拟文件系统（VFS）
	- 分区和安装

## 文件信息和文件控制结构的关系

**文件属性**：
- 名称、类型。
- 创建者、所有者。
- 位置、大小。
- 保护信息。
- 创建时间、最后一次修改时间和最后一次存储时间。

**FCB信息**：
- 基本信息：文件名、逻辑和物理结构、物理位置。
- 存取控制信息：各类用户的存取权限。
- 使用信息：文件建立和修改时间。

**磁盘索引结点信息**：类型、存取权限、物理地址、长度、存取时间、链接计数。

**内存索引结点信息**：索引结点编号、状态、访问计数、逻辑设备号、链接指针。

## 文件结构

### 逻辑结构

- 无结构文件（流式文件）
- 有结构文件（记录文件）
	- 顺序文件：串结构、顺序结构
	- 索引文件：
	- 索引顺序文件
	- 直接文件或散列文件

### 物理结构

- 连续分配
- 链接分配：隐式链接、显式链接
- 索引分配：对每个文件设置索引块。
- 混合索引分配：UNIX方式（一级、二级索引）。

比较：详见物理分配方式比较

## 文件操作

WIP

## 文件共享

**硬链接**：多个指针指向一个索引结点，保证只要有指针指向结点，索引结点便不删除。

**软链接**：把到达共享文件的路径记录下来。访问文件时，通过路径查找。

## 外存空闲空间管理

- 空闲表法
- 空闲链表法
- 位示图法
- 成组链接法

## 三种文件物理分配方式的比较

![[Pasted image 20230913213641.png]]

## 文件的打开方式

![[Pasted image 20230913213654.png]]

## 真题大题

### 2011：

![[Pasted image 20230913225607.png]]

第一问，连续存放方式最适合，因为数据不会被修改，而是会一次写入完毕。采用连续存放方式，磁盘寻道时间最短，文件随机访问效率最高。FCB中相关字段为：起始盘块号、盘块长度。

第二问，FCB集中存放更佳。这样随机查找文件只需遍历FCB区，而不需要连带遍历文件数据区。

### 2012：

![[Pasted image 20230913225644.png]]

第一问，磁盘块号至少占据4字节，可支持的单个文件最大大小为128KB。

第二问，直接索引结构有84个索引盘块，连续索引字段可以索引2^16个连续盘块，总共为`64MB+84KB`。

### 2014：

![[Pasted image 20230913225655.png]]
![[Pasted image 20230913225705.png]]

第一问，由于前后均有足够空间，所以考虑将记录前移。前29条记录分别需要前移一个盘块，每个盘块移动需要一次读取、一次写入，总共58次；第30条记录写入需要一次写入，因此总计59次。

第二问，通过29次访问找到第29个磁盘块，用一次访问将第30条记录写入一个新盘块，用一次操作修改第29个盘块的链接指针，总计操作31次。

### 2016：

![[Pasted image 20230913232512.png]]



### 2018：

![[Pasted image 20230913232524.png]]

### 2022：

![[Pasted image 20230913232539.png]]
![[Pasted image 20230913232555.png]]

