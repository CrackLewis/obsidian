
线性规划问题的*标准形*为：
$$
\begin{split}
\max\ & z=\sum_{j=1}^n c_j x_j \\
\text{s.t.}\ & \sum_{j=1}^n a_{ij}x_j = b_i, i=1,2,\cdots,m \\
& x_j\ge 0, j=1,2,\cdots,n
\end{split}
$$
其中：$b_i\ge 0,i=1,2,\cdots,m$。

注意：个别教材会指定标准形为$\min z$而非$\max z$。

## 一般问题转换为标准形

*目标变量替换*：若目标变量为$\min z=\sum_{j=1}^n c_jx_j$，则替换为：
$$
\max z'=\sum_{j=1}^n c_j'x_j=\sum_{j=1}^n -c_jx_j
$$
其中：$c_j'=-c_j$，$z'=-z$。

*单个条件变号*：若某个条件$\sum_{j=1}^n a_{ij}x_j=b_i<0$，则进行变号：
$$
\sum_{j=1}^n a_{ij}'x_j=b_i'>0
$$
其中：$a_{ij}=-a_{ij}'$，$b_i'=-b_i$。

*松弛变量*：若某个条件$\sum_{j=1}^n a_{ij}x_j\le b$是不等式，则替换为：
$$
\sum_{j=1}^n a_{ij}x_j+y_i=b_i
$$
其中$y_i\ge 0$为松弛变量。

*剩余变量*：若某个条件$\sum_{j=1}^n a_{ij}x_j\ge b$是不等式，则替换为：
$$
\sum_{j=1}^n a_{ij}x_j-y_i=b_i
$$
其中$y_i\ge 0$为剩余变量。

*自由变量代换*：若某个变量$x_j$没有明确限制$x_j\ge 0$，则将其拆为两个非负变量之差：
$$
x_j=x_j'-x_j''
$$
其中：$x_j'\ge 0$，$x_j''\ge 0$。

## 标准形性质

设$A=\{a_{ij}\}_{m\times n}$，$b=\{b_i\}_{m\times 1}$，$x=\{x_j\}_{n\times 1}$，$c=\{c_j\}_{n\times 1}$，$A$的第$j$列为$P_j=(a_{1j},a_{2j},\cdots,c_{mj})^T$。则标准形的*线代写法*：
$$
\begin{split}
\min\ & z=c^Tx \\
\text{s.t.}\ & Ax=\sum_{j=1}^n P_jx_j=b \\
& x_j,b_i\ge 0, 1\le i\le n, 1\le j\le m
\end{split}
$$

若标准形有解，则$rank(A)=m$是显然的，否则$Ax=b$无解，或者有可以舍去的约束条件。

标准形的*基*：$A$的$m$个无关向量$B=(P_{i_1},P_{i_2},\cdots,P_{i_m})$，对应基中列向量的变量$x_{i_1},x_{i_2},\cdots,x_{i_m}$称作*基变量*。其余变量为*非基变量*。
- 特别地，基变量记作$x_B=(x_{i_1},x_{i_2},\cdots,x_{i_m})^T$，非基变量记作$x_N$。

约束条件等价于$Ax=(B,N)(x_B,x_N)^T=b$。令$x_N=0$，则：
$$
Bx_B=b
$$
解得$x_B=B^{-1}b$，此为$Ax=b$关于基$B$的*基本解*。特别地，若$x_B\ge 0$，则$x_B$为*基本可行解*，$B$同时称为*可行基*。

**引理**：对于标准形，方程组$Ax=b$的一个解$\alpha$是基本解的充要条件是$x$中的非零分量对应的列向量线性无关。

（必要性显然，充分性可通过秩的性质得知）

**定理**：如果标准形有可行解，则必有基本可行解。

**定理**：如果标准形有最优解，则必存在一个基本可行解是最优解。

## 单纯形法

基本步骤：
- 确定初始的基本可行解。
- 检查当前的基本可行解，如果是最优解或无解，则结束；否则进行基变换，用一个非基变量替换一个基变量，得到一个新的可行基和对应的基本可行解，且使得目标函数值不下降。（如果目标是$\min z$则不提升）
- 重复基变换步骤，直至目标函数值不再变动。

### 确定初始基本可行解

略

### 最优性检验

假设可行基$B=(P_{\pi(1)},P_{\pi(2)},\cdots,P_{\pi(m)})$是由$A$中的一组不相关列向量组成的。则：
$$
Ax=(B,N)(x_B,x_N)^T=b
$$
两边乘$B^{-1}$，得：
$$
B^{-1}Ax=x_B+B^{-1}Nx_N=B^{-1}b
$$
解得：
$$
x_B=B^{-1}b-B^{-1}Nx_N
$$
代入目标函数，得到：
$$
\begin{split}
z&=c^Tx \\
&=c_B^T x_B+c_N^Tx_N \\
&=c_B^T(B^{-1}b-B^{-1}Nx_N)+c_N^Tx_N \\
&=c_B^TB^{-1}b+(c_N^T-c_B^TB^{-1}N)x_N
\end{split}
$$
$Ax=b$关于基$B$的基本可行解为$x=(x_B,x_N)^T=(B^{-1}b,0)^T$，对应的目标函数值为：
$$
z_0=c^Tx=c_B^T x_B+c_N^Tx_N=c_B^TB^{-1}b
$$
代入目标函数算式，得到：
$$
\begin{split}
z&=z_0+(c^T-c_B^TB^{-1}A)x
\end{split}
$$
记$\lambda^T=c^T-c_B^TB^{-1}A$，则$z=z_0+\lambda^Tx$，此时$\lambda^T=(\lambda_1,\lambda_2,\cdots,\lambda_n)$为*检验数*，表示相对于给定的基本可行解$z_0$，目标函数化简后表达式$z=z_0+\lambda^Tx$中的系数。

**定理**：记$B^{-1}A=\{\alpha_{ij}\}_{m\times n}$，$P_j'=B^{-1}P_j=(\alpha_{1j},\alpha_{2j},\cdots,\alpha_{mj})^T$，$\beta=B^{-1}b$。
- $x_{\pi(i)}=\beta_i-\alpha_{ik}x_k$。
- 若目标变量是$\max z$，且对于基本可行解$z_0$，有检验数$\lambda\le 0$，则$z_0$是最优解；若存在一个检验数$\lambda_k>0$，且所有$\alpha_{ik}\ge 0$，则无最优解。
- 若目标变量是$\min z$，且对于基本可行解$z_0$，有检验数$\lambda\ge 0$，则$z_0$是最优解；若存在一个检验数$\lambda_k<0$，且所有$\alpha_{ik}\le 0$，则无最优解。

### 基变换

以下的讨论来自教材《算法设计与分析》第三版，该教材统一认为目标变量是$\min z$而非$\max z$。注意区分。

WIP

## 