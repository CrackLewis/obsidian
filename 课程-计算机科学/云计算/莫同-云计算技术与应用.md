
技术：编程模型+分布式海量数据存储+大数据管理+资源虚拟化+资源管理调度

基本信息：
- 成绩：10平时+40实验+50考试=100
- 分组：3-6
- 形式：ppt+报告

240920：

![[Pasted image 20240920143944.png]]

## sec01-初识云计算

什么是云计算：
- 云：规模大、可扩展的虚拟网络介质
- 计算

云计算发展历程：
- 单个超级计算机
- 计算集群：1960-
- 分布式计算：任务分割->分布计算->结果合并
- 网格计算：1990-
- 效用计算
- 云计算：云+网络，通过网络自动分划/执行计算

资源虚拟化

面向服务的架构（service-oriented architecture，SOA）：
- 开放式数据模型+统一通信标准+更丰富的服务+更松散灵活的IT架构

软件即服务（software as a service，SaaS）
- 大公司负责基础设施，小公司负责创新
- 长尾理论

Web 2.0

*云计算的概念*：
- 云计算是一种能够将动态伸缩的虚拟化资源通过互联网以服务的方式提供给用户的计算模式。-by wiki
- 云计算是一种共享的网络交付信息服务的模式，云服务的使用者看到的只有服务本身，而不用关心相关基础设施的具体实现。

*云计算的分类*：灵活度和难易度递减
- 基础设施云：仅提供计算和存储设施
- 平台云：应用托管
- 应用云：个性化应用需求

服务方式：公有云、私有云、混合云

## sec03-云计算与服务

topics：
- 服务
- 云与服务
- 典型应用

### 3.1-服务

服务的供需：
- 供给驱动/需求驱动
- 搭建一个交互平台，使供需双方交互

交互平台的本质：
- 一个资源池，供需双方放入/取出
- 宏观上服务能力无限（可动态扩展），微观上服务能力有限（需要分配回收管控）
- 共性问题：
	- 虚拟化：服务的描述和访问
	- 分布式计算：大规模处理的效率问题
	- 管控策略：资源分配回收及其他管控问题

虚拟化：
- 资源描述：我有什么，你要什么
- 访问方式描述：怎么取出，怎么放入
- 虚拟化是资源在IT 世界中的抽象化“描述”技术

*分布式计算*：
- 背景：单机模式不能满足需求，分布式并行化是大势所趋
- 海量、高并发、存储要求、计算要求
- 通过架构的设计，将问题的瓶颈进行转换，以便提升

*管控策略*：
- 有了资源池之后，资源的放入和取出是关键
- 资源的管理
- 几乎所有的业务逻辑实际上都是资源的分配和回收策略

*什么是服务*：
- 通过一系列**活动**，满足对方的**需求**
- 以用户需求的满足度为核心，活动为主、实物为辅或无实物
- 提供服务与提供产品的区别（*服务的特点*）：
	- 产品趋于标准化、流水线化，服务趋于*个性化*
	- 服务中，用户的*参与度*更高
	- 产品的评价方式简单，服务则以顾客的*满意度*衡量
	- 产品注重实体属性，服务注重*价值*体现

### 3.2-云与服务

*云计算*：
- 资源服务化
- 计算和存储资源虚拟化
- 服务的可伸缩性、可用性、安全性

云平台模式：
- 输入资源->云平台->输出服务

对IT的需求：
- 应用层SaaS：软件即服务，面向最终用户
- 平台层PaaS：平台即服务，面向应用软件
- 基础设施层IaaS：基础设施即服务，面向软件

*云平台特点/优势*：
- 硬件与软件都是资源
- 资源可以根据需要进行动态扩展与配置：按需分配
- 按用计费、无需管理
- 物理上分布式共享，逻辑上以单一整体呈现
- 优化产业布局
- 推进专业分工：云计算厂商+科研+运维+开发
- 提升资源利用率
- 减少初期投资：更少的基础设施/人力/软件投入，更灵活的转型支持
- 降低管理开销：服务化管理，随机应变

### 3.3-典型应用

案例：
- Google：大数据存储与分析处理
- 12306：资源的弹性配置管理
- VMWare：IT资源管理与快速配置
- BAE/GAE：快速部署与实施

*DevOps*：
- Dev=开发，Ops=运维
- 目标：软件周期全流程自动化+全面监控
- 实施：组织、技术、流程、文化
- 动因：开发与上线分离，敏捷开发的诉求，配套技术（微服务+容器）的发展，开发的自动化
- 核心功能：自动打包/升级部署，用例管理和自动执行，用例开发框架，用例执行框架

*中台*：
- 概念：
	- 与前台（用户交互部分）和后台（数据管理+运行逻辑）相对的概念
	- 将“后台”中那些针对技术，业务，组织的通用“模块 服务”从原来特定的项目中抽离出来，并且使之能够成为一个自治的服务复用到多个项目中提供给更多的“前台”使用
- 分类：
	- 业务中台：
	- 应用中台：
	- 技术中台：数据存储与管理，数据分析处理，功能API，消息发布订阅
	- 数据中台

## sec04-典型云服务

topics：
- IaaS
- PaaS
- SaaS

### 4.1-IaaS

基础设施层服务（*IaaS*）：
- 经过虚拟化后的硬件资源和相关管理功能的集合
- 硬件资源：计算、存储和网络等资源
- 管理功能：物理资源虚拟化、内部流程自动化、资源管理优化，对外提供动态灵活的资源服务

*IaaS核心功能*：
- 资源抽象：
	- 定义：硬件虚拟化，屏蔽不同平台的差异，实行统一管理
	- 核心问题：对资源进行粒度划分并管理
	- 粒度分级：虚拟机<集群<虚拟数据中心<云
- 资源监控：
	- 对不同资源采取不同监控方式，保障基础设施层高效工作，是负载管理的前提
	- 监控层次：根据资源力度层次而定
	- 监控对象：物理单元、逻辑单元、解决方案
- 负载管理：
	- 动机：负载过低造成浪费，负载过高影响上层服务
	- 核心问题：负载平衡与优化问题（负载对性能/资源的影响，优化算法）
- 数据管理：
	- 多种数据并存，物理上分布式存储
	- 挑战：
		- 完整性：状态确定且一致，写操作同步，读写要么成功要么回滚
		- 可靠性：数据损坏和丢失概率最小，可从备份中恢复
		- 可管理性：相应的操作支持粗粒度、逻辑简单的管理
- 资源部署：
	- 分次、自动化部署，使基础设施服务变得可用
	- 典型场景：
		- 支持动态资源可伸缩性：负载过高时，增加实例
		- 故障恢复与硬件维护：多节点的数据冗余
- 安全管理：
	- 保证基础设施资源被合法地访问和使用
	- 云安全特点：环境更加开放，用户不保有数据，云内部破坏力更大
	- 影响云安全的因素：恶意程序、硬件故障、管理人员泄露、外在因素
- 计费管理：变买为租，按量计费

*IaaS实现步骤*：
- 总体设计：物理设施->虚拟化->管理系统->服务
- 服务流程：规划->部署->运行
- 规划阶段：
	- 虚拟化：准备物理环境、虚拟化改造、整合计算资源、建立统一接口
	- 用户访问及管理：允许用户通过客户端程序远程访问、获取资源
	- 数据管理：业务数据的管理、虚拟镜像文件的管理
- 部署阶段：分配资源->描述资源配置->接收激活命令->启动配置实例
- 运行阶段：
	- 虚拟机管理
	- 资源监控：黑盒管理（虚拟机资源监控）、白盒管理（软件资源监控）
	- 负载管理：基于资源，黑盒进行负载协调，白盒得到虚拟机负载
	- 安全管理：管理域、集成管理
	- 用户服务（账户计费、运行监控）

IaaS总体设计：

![[Pasted image 20241121162834.png]]

### 4.2-PaaS

*平台层服务*（PaaS）：
- 介于基础设施层和应用层之间
- 具有通用性和可复用性的软件资源集合，为云应用提供开发、运行、管理和监控的环境
- 更好的满足云应用的可伸缩性、可用性和安全性

*PaaS核心功能*：
- 开发平台：平台层是其上运行应用的开发平台
	- 应用模型：编程语言、元数据模型、打包发布格式
	- API代码库
	- 开发测试环境：离线开发测试+上传模式
- 运行时环境：
	- 任务：打包/部署应用上线，并根据元数据进行配置
	- 隔离性：业务隔离、数据隔离、应用间隔离、用户间隔离
	- 可伸缩性：根据业务规模和工作负载，分配计算能力、存储、网络带宽等资源
	- 资源可复用性：宏观上无限，微观上有限
- 运营环境：
	- 应用更新
	- 应用升级：升级/上传补丁，升级失败恢复
	- 应用监控：应用运行状态（负载/异常）、监控手段（响应时间/吞吐量/负载/请求量）、图形化展示
	- 资源消耗监控
	- 应用卸载
	- 应用计费统计：业务使用/资源使用统计

*PaaS实现步骤*：
- 总体设计
- 开发平台：应用模型（如J2EE）、服务提供方式（REST、SOAP）、核心API（SDK）、发布格式（JAR包）、开发测试环境
- 运行环境：可伸缩实现机制
	- 方案A：每个应用与其数据库打包为一个实例。部署简单，灵活性受限，延迟较低。
	- 方案B：每个应用和每个数据库单独打包。灵活性更高，部署较复杂，延迟较高。
- 运营环境

### 4.3-SaaS

*应用层服务*（SaaS）：
- 建立在平台层之上，云上应用软件的集合
- 种类：
	- 面向广大受众的标准化应用
	- 定制的个性化服务应用
	- 用户开发的多元化应用

*应用层的特征*：
- 网络访问模式：浏览器模式、客户端模式
- 租用付费：按用量付费
- 高度整合：用户需求的综合性，用户体验为导向

![[Pasted image 20241121205551.png]]

*应用层的应用分类*：
- 标准应用：运行在平台层，服务质量约等于本地运行，功能丰富，通信效率高
- 客户应用：通用模板，部分定制化，迁移较困难
- 多元应用：高度定制化

![[Pasted image 20241121211114.png]]

*Serverless*：
- 组成：Serverless=FaaS+BaaS
	- FaaS：Serverless架构允许用户以一种更加“代码碎片化”的方式开发软件，将软件服务更加细粒度到函数层面，通过函数即服务Function as a Service（FaaS）的组合构建自己的代码
	- BaaS：FaaS和对应的支撑服务后端即服务Backend as a Service（BaaS）共同构成了Serverless
- 工作流程：编写代码->上传平台->触发函数实例->实例弹性执行各函数->按量计费
- 函数操作（P86）
	- 版本控制、别名
	- 事件源与函数关联
	- 函数及工作量要求
	- 函数调用：同步请求（HTTPS等）、异步消息队列（RabbitMQ、AWS、SNS等）、消息/记录流（Kafka等）、批量作业（ETL等）
- Serverless vs SaaS：
	- Serverless是SaaS基础上演进的结果，不是简单归属于SaaS

## sec05-虚拟化技术

### 5.1-虚拟化技术概述

云计算的核心思想是服务：
- 计算资源服务化：
	- 核心挑战：解耦、建立资源池、资源分配回收、分配资源间独立性
- 开发平台服务化
- 应用软件服务化
- XaaS

*什么是虚拟化*：
- 将原本存在于真实环境上的计算机系统或组件运行在虚拟出来的环境中，解除真实环境中各个层次的耦合关系
- 虚拟化与云的关系：
	- 云是一种平台模式，把资源汇聚，然后再以服务方式对外提供
	- 本质上是虚拟表示的汇聚：实际的使用仍然是“实体”，但通过虚拟化接口访问
- 虚拟化本质：在使用者和实体间增加一层抽象 ![[Drawing 2024-11-22 10.55.24.excalidraw|300]]
- 虚拟化发展历程：虚拟内存->JVM->服务器虚拟化
- 虚拟化典型类型：
	- 基础设施虚拟化：网络（VPN/VLAN）、存储虚拟化（RAID/NAS/区域存储网）
	- 系统虚拟化：Windows/Linux
	- 软件虚拟化：JVM
- 虚拟化典型架构：硬件层-VM-OS
- 为什么进行虚拟化：
	- 降低运营成本，提高应用兼容性，加速应用部署
	- 提高服务可用性，提升资源利用率，动态调度资源，降低能源消耗

### 5.2-服务器虚拟化

基本概念/特性/核心技术

服务器管理的主要问题：
- 整合：增加服务器的平均性能，降低服务器数量
- 集中：多个设备的运行内容集中到单个设备
- 数据集成、应用集成

*服务器虚拟化*：
- 将虚拟化技术运用到服务器上，将物理服务器虚拟化为数个虚拟服务器
- 目标：高性能、可扩展和稳定，支持多种IT需求

服务器虚拟化的*核心技术*：
- 计算虚拟化：
	- CPU虚拟化：
		- 全虚拟化：软件模拟硬件设备，拦截执行VM内特权指令
		- 半虚拟化：改造OS内核，使VM与实际机共享底层调用
	- CPU硬件辅助虚拟化：硬件集成虚拟化逻辑
	- GPU虚拟化：
		- 虚拟显卡：虚拟网络计算机VNC、OpenGL伪库VMGL
		- 显卡直接调用：显卡分配给VM，VM使用对应驱动
		- 显卡虚拟化：VM获取和使用显卡时间片
- 存储虚拟化：
	- 内存虚拟化：
		- VM传统访存方式：VM逻辑地址GVA->VM物理地址GPA->OS逻辑地址HVA->OS物理地址HPA
		- 影子页表法SPT：为VM系统的每个进程维护一套影子页表，提供GVA到HPA的直接映射，由Hypervisor维护，由物理机MMU直接映射。缺页由Hypervisor处理
		- EPT/NPT：硬件上固化扩展的MMU，为每个VM维护GPA->HPA的映射。GVA->GPA由VM内部管理。缺页由宿主机OS处理
	- 磁盘虚拟化：
		- 本地存储虚拟化
		- 存储区域网络SAN（storage area network）：面向存储空间，用于块I/O
			- 磁盘阵列RAID：RAID1镜像备份、RAID3校验信息备份、RAID5交叉存储、RAID7独立运行
		- 网络接入存储NAS（network attached storage）：面向存储内容，用于文件I/O
- 设备与I/O虚拟化：
- 网络虚拟化：
- 容器虚拟化：
- 实时迁移技术：

### 5.3-其他虚拟化技术

## 思考题汇总

sec01：WIP

sec02：OpenStack实验，略

sec03：
- 服务的概念
- 云的技术范畴
- 云服务的基本层次
- 云的特征
- 云的优势
- 什么是DevOps，其作用是什么
- 什么是中台，中台作用有哪些，主要中台有哪些

sec04：
- IaaS的基本功能
- PaaS的基本功能
- SaaS的典型应用

sec05：
- 虚拟化的概念
- 服务器虚拟化的特性
- 服务器虚拟化的关键技术
- 其他虚拟化的相关技术
- 典型虚拟机
- 虚拟化与云计算的关系