
基本信息：
- 主课+课程实验+xv6源码分析+课堂讨论
- 课程：
	- PKU课程：
	- mooc：
	- GitHub仓库：[repo](https://github.com/wuhao9714/myNachos3.4)
- 参考资料：[OSTEP](https://pages.cs.wisc.edu/~remzi/OSTEP/)、《现代操作系统》、《》
- 课程评定：60平时（35课程实验+10源码阅读+15课堂互动）+40考试=100

xv6：
- src: MIT
- 支持对称多处理器（SMP）和RISC-V架构

读代码：
- kernel/entry.S, kernel/start.c, kernel/memlayout.h, kernel/main.c
- kernel/trap.c, kernel/trampoline.S, kernel/syscall.h, kernel/syscall.c, kernel/kernelvec.S, kernel/console.c, kernel/uart.c

lab:
- lab评测平台已导入各位同学的账号，请访问course.educg.net登录，账号为pku+你的学号，例如pku2400011223，初始密码为pku123456。
- 其他有关平台提交lab的使用方式和注意事项请参考本文档：[文档](https://oyer359xyx.feishu.cn/docx/HUOldvsKvojKq4xFGGPc8n42nPc)
- 简单写了下本课程使用的lab的环境配置等问题的指导，9月27日课程上也会讲解lab环境配置和提交方式。有时间精力的同学可以参照本文档开始在本地做lab了：[文档](https://oyer359xyx.feishu.cn/docx/SGDNdxCkuoMSV6xUgX5cPJCTnMe)

这个RISC-V中断机制讲的不错：[lnk](https://gitee.com/hustos/pke-doc/blob/master/chapter1_riscv.md#14-%E4%B8%AD%E6%96%AD%E5%92%8C%E4%B8%AD%E6%96%AD%E5%A4%84%E7%90%86)

## OS实验

不知为何，默认SBI可以启动，但rustsbi启动不了：

```sh
make run SBIPATH=default # OK
make run SBI=sbi-qemu-2 # fail
```

UPD: 实锤是辣鸡clab主机的锅，换Docker就好了（

基于QEMU和GDB的调试：
- 首先在QEMUOPTS中加`-s`，表示在默认端口1234上调试（自定义端口`-s tcp::<port>`）
- 启动`gdb-multiarch`或交叉编辑器的`gdb`，目标程序为内核
- GDB内执行`target remote:<port>`，如为默认端口则port为1234
- 设置必要的断点，如`b consoleread`等

## milestones

| 系统调用           | 调用号 | 难度  | 进度  |
| -------------- | --- | --- | --- |
| `exit`         |     | D   |     |
| `getpid`       |     | D   | ✔   |
| `getppid`      |     | D   | ✔   |
| `gettimeofday` |     | D   |     |
| `uname`        |     | D   |     |
| `times`        |     | D   |     |
| `brk`          |     | D   |     |
| `clone`        |     | C   |     |
| `fork`         |     | C   |     |
| `wait`         |     | C   |     |
| `waitpid`      |     | C   |     |
| `mmap`         |     | C   |     |
| `munmap`       |     | C   |     |
| `execve`       |     | C   |     |
| `close`        |     | B   |     |
| `dup`          |     | B   |     |
| `dup2`         |     | B   |     |
| `pipe`         |     | B   |     |
| `read`         |     | B   |     |
| `write`        |     | B   |     |
| `openat`       |     | A   |     |
| `open`         |     | A   |     |
| `fstat`        |     | A   |     |
| `getdents`     |     | A   |     |
| `chdir`        |     | A   |     |
| `getcwd`       |     | A   |     |
